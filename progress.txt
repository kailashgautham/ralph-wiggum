# Progress Tracker
# Each completed task is logged here by the agent.
# Format: [DONE] Task description

[DONE] Fix Dockerfile to copy ralph-lib.sh into the image: the COPY instruction in Dockerfile lists only ralph.sh, ralph-once.sh, and entrypoint.sh, but both ralph.sh and ralph-once.sh source ralph-lib.sh at startup; the container therefore fails immediately with a "No such file or directory" error on every run; add ralph-lib.sh to the COPY line and to the chmod +x line so it is present and executable inside the image
[DONE] Allow RALPH_LOG_KEEP=0 to disable log rotation by fixing validate_int usage: ralph.sh treats RALPH_LOG_KEEP=0 as "keep all logs, skip rotation" (the rotation block is guarded by `if [ "${RALPH_LOG_KEEP}" -gt 0 ]`), but validate_int uses the regex `^[1-9][0-9]*$` which rejects zero; a user who sets RALPH_LOG_KEEP=0 gets a misleading "must be a positive integer" error instead of the intended behaviour; introduce a separate validate_non_negative_int helper (accepting 0 or any positive integer) and use it for RALPH_LOG_KEEP while keeping validate_int for values that must be at least 1
[DONE] Update README.md Files table and architecture section to document ralph-lib.sh and tests/: both ralph-lib.sh (the shared helper library) and the tests/ directory were introduced in recent iterations but are absent from the README's Files table and architecture description; add a row for ralph-lib.sh explaining it is a sourced helper with shared functions, add a row for tests/run_tests.sh explaining it is the test harness, and add a brief "Testing" subsection describing how to run the tests manually
[DONE] Extract the duplicated planning-call retry loop into ralph-lib.sh as a shared function: the planning-call block (build PLAN_CMD array, retry up to MAX_RETRIES with exponential backoff, log warnings on failure) is copy-pasted almost verbatim in both ralph.sh (lines ~287–310) and ralph-once.sh (lines ~155–178); the same duplication that motivated extracting ralph_commit_push_pr applies here; add a ralph_run_planning_call function to ralph-lib.sh that accepts the prompt as its first argument and uses the same globals (CLAUDE_MODEL, RALPH_TIMEOUT, RALPH_ALLOWED_TOOLS, MAX_RETRIES, RETRY_DELAY, RUN_LOG) already used by the other shared helpers, then replace both inline blocks with a single call to this function
[DONE] Add a GitHub Actions CI workflow that runs tests/run_tests.sh on every push and pull request: there is currently no automated test execution; any regression in ralph.sh, ralph-once.sh, or docker-ralph.sh will only be caught if a developer manually runs the test harness; create .github/workflows/ci.yml with a single job that checks out the repo, installs flock (util-linux) as a dependency, and runs bash tests/run_tests.sh, reporting success or failure
[DONE] Add --verbose flag to the planning call in ralph-once.sh to match ralph.sh: the PLAN_CMD array in ralph-once.sh is built without --verbose while the equivalent block in ralph.sh includes it; this inconsistency means planning-phase tool calls and reasoning are silent in ralph-once.sh but visible in ralph.sh; add --verbose to the PLAN_CMD construction in ralph-once.sh so both scripts behave identically during the planning phase
[DONE] Make the Claude Code version in Dockerfile configurable via a build ARG: the npm install line hardcodes @anthropic-ai/claude-code@2.1.50; users who want to upgrade or pin a different version must edit the Dockerfile directly; add a CLAUDE_CODE_VERSION build ARG with a default of 2.1.50 and substitute it into the npm install command so users can override it with docker build --build-arg CLAUDE_CODE_VERSION=x.y.z without modifying the file
