# Progress Tracker
# Each completed task is logged here by the agent.
# Format: [DONE] Task description

[DONE] Deduplicate retry/backoff logic in ralph_run_main_call and ralph_run_planning_call: both functions in ralph-lib.sh implement an almost identical while-loop with exponential backoff (differing only in whether output is tee'd to a tmpfile for capture or streamed directly to a log); extract a shared internal helper _ralph_invoke_claude_with_retry that accepts the claude command array and a "capture to file" flag, runs the retry loop including the credit-exhaustion branch, and returns exit_code; rewrite ralph_run_main_call and ralph_run_planning_call as thin wrappers that build their respective cmd arrays and delegate to the helper, eliminating the duplicated while/sleep/backoff code
[DONE] Add tests for docker-ralph.sh status and --dry-run delegating to ralph.sh on the host: these two subcommands exec ralph.sh directly without Docker, but run_tests.sh has no coverage of this path; add two tests that set up a minimal git repo with PRD.md, provide a stub docker binary on PATH that always exits non-zero (to prove Docker is never invoked), and run docker-ralph.sh status / docker-ralph.sh --dry-run from inside the repo; assert exit 0 and that the output contains "Ralph Status" or "Next task:" respectively
[DONE] Add a RALPH_ITER_HOOK environment variable that is eval'd at the start of each iteration in ralph.sh before the Claude invocation: when RALPH_ITER_HOOK is set, export RALPH_CURRENT_ITER (the current iteration number, 1-based) and RALPH_MAX_ITER (the value of MAX) then run eval "$RALPH_ITER_HOOK" at the top of the for-loop body immediately before ralph_run_main_call, and log a one-line notice to RUN_LOG when the hook is configured; document RALPH_ITER_HOOK, RALPH_CURRENT_ITER, and RALPH_MAX_ITER in ralph.sh --help, docker-ralph.sh --help (and its ENV_ARGS forwarding block), and README.md's environment variables table; add one test to tests/run_tests.sh that sets RALPH_ITER_HOOK to write RALPH_CURRENT_ITER to a file and asserts the file contains "1" after a single iteration
